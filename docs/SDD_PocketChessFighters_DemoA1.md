# 口袋棋兵（Pocket Chess Fighters）— 簡單版 SDD（Static HTML Demo A-1）
版本：v0.1  
日期：2026-02-28  
目標：交給 AI 接手開發的「最小可玩」靜態網頁版本規格與交付物描述

---

## 1. 專案範圍（這一版只做什麼）

### 1.1 版本定位：Demo A-1（單人移動 + 遭遇 NPC 判定）
本版本只做一個「可以直接在瀏覽器開啟遊玩」的單檔靜態網頁：

- 六角棋盤（Hex Grid）隨機產生格子屬性（STR/AGL/VIT/DEX/LUK/INT）與正負號（+ / -）
- 1 名玩家角色（可點擊相鄰格移動，有滑順動畫）
- 1 名 NPC（固定為紅色標記）
- 玩家走到 NPC 同一格時，立即觸發判定：
  - `+`：比大（數值大者勝）
  - `-`：比小（數值小者勝）
  - 平手：以 LUK 加權擲骰決勝
- 勝利：NPC 重新丟到隨機格、玩家勝場 +1
- 落敗：Game Over（可重開）

> 注意：本版本 **不做** 40 人、縮圈、撞棋 NPC、多角色、排名、台詞、音效、存檔等。

---

## 2. 遊玩內容（Playable Spec）

### 2.1 操作方式
- 滑鼠移動：Hover 高亮格子
- 滑鼠點擊：
  - 若點擊的是玩家「相鄰」六角格（距離=1）→ 角色移動到該格
  - 其他位置點擊無效（避免超距移動）

### 2.2 遭遇與戰鬥
- 觸發條件：玩家移動結束後，若玩家座標 == NPC 座標
- 使用玩家所在格子的屬性與正負號做判定

#### 判定流程
1. 取得格子 `tile.stat`（六屬性之一）與 `tile.sign`（+1 或 -1）
2. 讀玩家與 NPC 在該屬性的數值：`pVal`、`eVal`
3. 若 `pVal != eVal`：
   - `tile.sign == +1` → `pVal > eVal` 玩家勝
   - `tile.sign == -1` → `pVal < eVal` 玩家勝
4. 若 `pVal == eVal`：進入平手流程（LUK 加權擲骰）

#### 平手（LUK 加權擲骰）
- 玩家擲骰：`pRoll = d20 + p.LUK`
- NPC 擲骰：`eRoll = d20 + e.LUK`
- 大者勝；若仍平手則隨機決勝（50/50）

### 2.3 勝敗處理
- 玩家勝：
  - `wins += 1`
  - NPC 隨機重生到盤面上的一個格子（避免與玩家同格）
- 玩家敗：
  - `gameOver = true`
  - 顯示 Game Over overlay
  - 玩家不可再移動，直到按「重開一局」

---

## 3. 資料結構（Data Model）

### 3.1 屬性枚舉
- `["STR","AGL","VIT","DEX","LUK","INT"]`

### 3.2 Tile（格子）
- `stat`: 六屬性之一
- `sign`: `+1` 或 `-1`

鍵值儲存：`Map<"q,r", Tile>`

### 3.3 Unit（角色）
- `name`
- `stats`: `{ STR, AGL, VIT, DEX, LUK, INT }`
- `q, r`: axial 座標
- `x, y`: 世界座標（像素）
- `tx, ty`: 目標世界座標（像素）
- `moving`: 是否在移動動畫中

---

## 4. 棋盤規格（Hex Grid）

### 4.1 座標系
- Axial Coordinate：`(q, r)`
- 棋盤半徑：`R = 4`（共 61 格）
  - 若要升級到 127 格：`R = 6`

### 4.2 格子生成
- 遍歷 `q=-R..R`、`r=-R..R`，用距離判定在六角範圍內才生成
- 每格隨機：
  - `stat` 從六屬性均勻抽取
  - `sign` 50% 機率為 `+1` 或 `-1`

### 4.3 移動限制
- 僅允許距離 `dist(player, target) == 1` 的相鄰格

---

## 5. 視覺與 UI（UI/UX）

### 5.1 畫面元素
- 六角格：顯示「屬性 +/−」文字
- 玩家：白色圓形（帶簡單耳朵造型）
- NPC：紅色圓形，且 NPC 所在格外框更明顯
- 可走格提示：玩家周圍相鄰格線框變亮
- Hover 高亮：滑鼠所在格線框加粗變亮

### 5.2 HUD 面板內容
- 玩家座標
- NPC 座標
- 玩家所在格（屬性與 +/−）與規則提示（比大/比小）
- 勝場 wins
- 狀態（進行中 / Game Over）
- 玩家屬性（固定示例）
- NPC 屬性（每局重新亂數偏科）
- 最近一次判定紀錄（log）

### 5.3 遊戲狀態限制
- Game Over 後：禁止移動
- 提供按鈕：
  - 重新亂數棋格
  - 鏡頭置中
  - 重開一局

---

## 6. 交付物（Deliverables）

### 6.1 單檔可執行 HTML
- `index.html`
- 需求：任何現代瀏覽器可直接開啟遊玩
- 不依賴外部 CDN、框架或建置工具

### 6.2 SDD（本文件）
- `SDD_PocketChessFighters_DemoA1.md`

---

## 7. 後續擴充（AI 接手開發建議 Roadmap）

### 7.1 立刻可加（不改架構）
1. NPC 被擊退動畫（tween 到新格）
2. 加入 3~5 個 NPC（多遭遇）
3. 每次勝利後「重骰盤面」或「局部重骰」
4. 平手機制改成「LUK 越高越容易贏」的機率模型（如 softmax）

### 7.2 轉成完整 Pocket Chess Fighters 的最短路
1. 增加多角色（玩家 1 + NPC 4 → NPC 10 → NPC 39）
2. 增加回合制流程：Decision → Action → Resolution
3. 增加淘汰/排名邏輯
4. 加入縮圈（RingShrinkSystem）
5. 加入撞棋 NPC（KnockbackSystem）

---

## 8. 驗收清單（Acceptance Criteria）
- [ ] 打開 `index.html` 可直接遊玩
- [ ] 只能點相鄰格移動
- [ ] 每格都有隨機屬性與 +/−
- [ ] 走到 NPC 格會觸發判定並寫入 log
- [ ] 玩家勝利：wins 增加、NPC 重新出現到其他格
- [ ] 玩家落敗：Game Over、禁止再移動、可重開

